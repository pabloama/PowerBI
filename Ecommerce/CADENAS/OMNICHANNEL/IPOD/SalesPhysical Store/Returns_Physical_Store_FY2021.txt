// Bershka_Returns_Physical_Store_FY2021
let
    Source = Oracle.Database("EXAPRO_REP", [HierarchicalNavigation=true, Query="-- ORACLE EXADATA - DW ECOMMERCE - Bershka - OMNICHANNEL - IPOD - VENTA TIENDA FÃSICA PRESENCIAL - DEVOLUCIONES - FY2020#(lf)SELECT#(lf)  v.ID_FECHA,#(lf)  SUM(v.UNIDADES) unidades,#(lf)  SUM(v.IMPORTE) local_amount,#(lf)  SUM(ROUND (v.IMPORTE * dp.CAMBIO_REFERENCIA, 2)) amount_euros,#(lf)  dp.DESCRIPCION market,#(lf)  dp.DESCRIPCION_INGLES market_english,#(lf)  dp.PAIS,#(lf)    dp.PAIS_ISO,#(lf)  dl.LOCALIZACION,#(lf)  dl.DESCRIPCION physical_store#(lf)FROM  DMCOMERCIAL.MIC_FACT_VTA_BRU_PRES_CAD v#(lf)INNER JOIN DMCOMERCIAL.DIM_LOCALIZACION dl#(lf)  ON dl.ID_LOCALIZACION = v.ID_LOCALIZACION#(lf)INNER JOIN DMCOMERCIAL.DIM_PAIS dp#(lf)  ON dp.ID_PAIS = dl.ID_PAIS#(lf)WHERE #(lf)  v.ID_FECHA >= TO_DATE ('01/02/2021', 'DD/MM/YYYY') #(lf)    AND v.ID_FECHA < TO_DATE ('01/02/2022', 'DD/MM/YYYY')#(lf)      AND v.ID_T_AGR_MOV_VTA = 2 -- RETURN TRANSACTION#(lf)        AND v.ID_SUB_T_AGR_MOV_VTA = 1 -- 1 - PHYSICAL TRANSACTION, 2 - .COM WITH COD, 3 - SINT, 4 - IPOD#(lf)#(tab)  AND dl.ID_CADENA = 5 -- Bershka#(lf)GROUP BY#(lf)  v.ID_FECHA,#(lf)  dp.PAIS,#(lf)  dp.DESCRIPCION,#(lf)  dp.DESCRIPCION_INGLES,#(lf)  dp.PAIS_ISO,#(lf)  dl.LOCALIZACION,#(lf)  dl.DESCRIPCION", CommandTimeout=#duration(0, 7, 0, 0)])
in
    Source