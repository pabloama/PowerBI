// Bershka_Store_Visits_FY2020
let
    Source = Oracle.Database("EXAPRO_REP", [HierarchicalNavigation=true, Query="-- ORACLE EXADATA - DW ECOMMERCE - Bershka - OMNICHANNEL - IPOD - VISITAS PERSONAS TIENDA FÍSICA - FY2020#(lf)WITH m AS(#(lf)    SELECT#(lf)        ID_FECHA,#(lf)        ID_LOCALIZACION,#(lf)        MAX (TOTAL_NUMERO_ENTRADAS) max_total_entradas,#(lf)        MAX (TOTAL_NUMERO_SALIDAS) max_total_salidas#(lf)    FROM DMCOMERCIAL.MIC_FACT_CONTEO_PER_LOCSEC#(lf)    GROUP BY#(lf)        ID_FECHA,#(lf)        ID_LOCALIZACION#(lf))#(lf)SELECT#(lf)#(tab)c.ID_FECHA,#(lf)#(tab)c.ID_LOCALIZACION,#(lf)#(tab)c.TOTAL_NUMERO_ENTRADAS,#(lf)#(tab)c.TOTAL_NUMERO_SALIDAS,#(lf)#(tab)c.ESTADO_COMUNICACION,#(lf)#(tab)dp.DESCRIPCION market,#(lf)#(tab)dp.DESCRIPCION_INGLES market_english,#(lf)#(tab)dp.PAIS,#(lf)#(tab)dp.PAIS_ISO,#(lf)#(tab)dl.LOCALIZACION,#(lf)#(tab)dl.DESCRIPCION physical_store#(lf)FROM m#(lf)INNER JOIN DMCOMERCIAL.MIC_FACT_CONTEO_PER_LOCSEC c#(lf)  ON c.ID_FECHA = m.ID_FECHA#(lf)    AND c.ID_LOCALIZACION = m.ID_LOCALIZACION#(lf)      AND c.TOTAL_NUMERO_ENTRADAS = m.max_total_entradas#(lf)      AND c.TOTAL_NUMERO_SALIDAS = m.max_total_salidas#(lf)INNER JOIN DMCOMERCIAL.DIM_LOCALIZACION dl#(lf)    ON dl.ID_LOCALIZACION = c.ID_LOCALIZACION#(lf)INNER JOIN DMCOMERCIAL.DIM_PAIS dp#(lf)    ON dp.ID_PAIS = dl.ID_PAIS#(lf)WHERE #(lf)    c.ID_FECHA >= TO_DATE ('01/02/2020', 'DD/MM/YYYY') #(lf)        AND c.ID_FECHA < TO_DATE ('01/02/2021', 'DD/MM/YYYY')#(lf)        AND dl.ID_CADENA = 5 -- Bershka#(lf)        AND c.ESTADO_COMUNICACION = 0 -- COMUNICACIÓN CORRECTA#(lf)GROUP BY#(lf)#(tab)c.ID_FECHA,#(lf)#(tab)c.ID_LOCALIZACION,#(lf)#(tab)c.TOTAL_NUMERO_ENTRADAS,#(lf)#(tab)c.TOTAL_NUMERO_SALIDAS,#(lf)#(tab)c.ESTADO_COMUNICACION,#(lf)#(tab)dp.DESCRIPCION,#(lf)#(tab)dp.DESCRIPCION_INGLES,#(lf)#(tab)dp.PAIS_ISO,#(lf)#(tab)dp.PAIS,#(lf)#(tab)dl.LOCALIZACION,#(lf)#(tab)dl.DESCRIPCION#(lf)ORDER BY#(lf)  c.ID_FECHA ASC,#(lf)  c.ID_LOCALIZACION ASC", CommandTimeout=#duration(0, 7, 0, 0)])
in
    Source