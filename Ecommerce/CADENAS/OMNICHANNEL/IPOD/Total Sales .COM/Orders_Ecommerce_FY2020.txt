// Bershka_Orders_Ecommerce_FY2020
let
    Source = Oracle.Database("EXAPRO_REP", [HierarchicalNavigation=true, Query="-- ORACLE EXADATA - DW ECOMMERCE - PEDIDOS - Bershka - FY2020#(lf)SELECT #(lf)#(tab)mf.ID_FECHA,#(lf)#(tab)COUNT(DISTINCT mf.ID_PEDIDO_ECOMMERCE) pedidos,#(lf)#(tab)SUM(mf.UNIDADES) unidades,#(lf)#(tab)SUM(mf.IMPORTE) local_amount,#(lf)#(tab)SUM(ROUND (mf.IMPORTE * mf.CAMBIO_REFERENCIA, 2)) amount_euros,#(lf)#(tab)mf.ID_CADENA,#(lf)#(tab)dp.PAIS,#(lf)#(tab)dp.DESCRIPCION market,#(lf)  dp.DESCRIPCION_INGLES market_english#(lf)FROM DMCOMERCIAL.MIC_FACT_PEDIDO_DEVOL_ECOMM mf#(lf)INNER JOIN DMCOMERCIAL.DIM_PAIS dp#(lf)#(tab)ON (dp.ID_PAIS = mf.ID_PAIS)#(lf)WHERE #(lf)#(tab)mf.ID_FECHA_PLATAFORMA >= TO_DATE ('01/01/2020', 'DD/MM/YYYY')#(lf)  AND mf.ID_FECHA_PLATAFORMA < TO_DATE ('01/03/2021', 'DD/MM/YYYY')#(lf)#(tab)AND mf.ID_FECHA >= TO_DATE ('01/02/2020', 'DD/MM/YYYY')#(lf)  AND mf.ID_FECHA < TO_DATE ('01/02/2021', 'DD/MM/YYYY')#(lf)#(tab)AND mf.ID_TIPO_MOVIMIENTO IN (72, 772) -- ORDER TRANSACTION#(lf)#(tab)AND mf.ID_CADENA = 5 -- Bershka#(lf)#(tab)AND mf.ESTADO NOT IN ('X', 'N', 'PQ') -- DRIVE CADENAS#(lf)#(tab)AND mf.REPOSICION = 0 -- DRIVE#(lf)#(tab)AND mf.ID_SECCION > 0 -- DRIVE#(lf)#(tab)AND mf.ID_PAIS > 0 -- DRIVE#(lf)GROUP BY #(lf)#(tab)mf.ID_FECHA,#(lf)#(tab)mf.ID_CADENA,#(lf)#(tab)dp.DESCRIPCION,#(lf)  dp.DESCRIPCION_INGLES,#(lf)#(tab)dp.PAIS", CommandTimeout=#duration(0, 7, 0, 0)])
in
    Source
