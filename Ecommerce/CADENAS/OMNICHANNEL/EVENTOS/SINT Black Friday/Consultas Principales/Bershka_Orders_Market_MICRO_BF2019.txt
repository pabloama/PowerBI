// Bershka_Orders_Market_MICRO_BF2019
let
    Source = Oracle.Database("EXAPRO_REP", [HierarchicalNavigation=true, Query="-- ORACLE EXADATA - DW ECOMMERCE - PEDIDOS SINT - BERSHKA - MERCADO - FY2019, FY2020#(lf)SELECT#(lf)  mf.ID_FECHA,#(lf)  COUNT(DISTINCT mf.ID_PEDIDO_ECOMMERCE) pedidos,#(lf)  SUM(mf.UNIDADES) unidades,#(lf)  SUM(mf.IMPORTE) local_amount,#(lf)  SUM(ROUND (mf.IMPORTE * mf.CAMBIO_REFERENCIA, 2)) amount_euros,#(lf)  dp.DESCRIPCION_INGLES market_english,#(lf)  dp.PAIS#(lf)FROM DMCOMERCIAL.MIC_FACT_PEDIDO_DEVOL_ECOMM mf#(lf)INNER JOIN DMCOMERCIAL.DIM_PAIS dp#(lf)  ON dp.ID_PAIS = mf.ID_PAIS#(lf)INNER JOIN DMCOMERCIAL.DIM_LOCALIZACION dl1#(lf)  ON dl1.ID_LOCALIZACION = mf.ID_LOCALIZACION_ALM_PICKING#(lf)  AND dl1.ID_TIPO_LOC IN (12, 13, 15, 16, 17, 18, 19, 20, 21, 81, 121) -- PICKING EN TIENDA#(lf)INNER JOIN DMCOMERCIAL.DIM_LOCALIZACION dl2#(lf)  ON dl2.ID_LOCALIZACION = mf.ID_LOCALIZACION_ALMACEN#(lf)  AND dl2.ID_TIPO_LOC IN (12, 13, 15, 16, 17, 18, 19, 20, 21, 81, 121) -- EXPEDICIÃ“N DESDE TIENDA#(lf)WHERE#(lf) mf.ID_FECHA_PLATAFORMA BETWEEN TO_DATE ('28/10/2019', 'DD/MM/YYYY')#(lf)    AND TO_DATE ('01/02/2020', 'DD/MM/YYYY')#(lf)  AND mf.ID_FECHA BETWEEN TO_DATE ('27/11/2019', 'DD/MM/YYYY') #(lf)    AND TO_DATE ('29/11/2019', 'DD/MM/YYYY') #(lf)  AND mf.ID_TIPO_MOVIMIENTO IN (72, 772) -- ORDER TRANSACTION#(lf)  AND mf.ESTADO NOT IN ('X', 'N', 'PQ') #(lf)  AND mf.ID_CADENA = 5 -- BERSHKA #(lf)  AND mf.REPOSICION = 0 -- DRIVE#(lf)  AND mf.ES_CAMBIO = 0 -- DRIVE#(lf)  AND mf.ID_SECCION > 0 -- DRIVE#(lf)  AND mf.ID_PAIS > 0 -- DRIVE#(lf)  AND dl1.LOCALIZACION > 0 -- QUITAMOS LOS ""NO TIENE""#(lf)GROUP BY#(lf)  mf.ID_FECHA,#(lf)  dp.PAIS,#(lf)  dp.DESCRIPCION_INGLES", CommandTimeout=#duration(0, 7, 0, 0)])
in
    Source